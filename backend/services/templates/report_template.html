<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1, h2 {
            color: #333;
        }
        #charts-container > div {
            width: 100%;
            max-width: 100%;
            height: 500px; /* Hauteur par d√©faut */
            margin-bottom: 40px;
        }
    </style>
</head>
<body>
    <h1>{{ title }}</h1>
    <p>{{ description }}</p>

    {% if stats %}
        <h2>Statistiques descriptives</h2>
        <pre>{{ stats | tojson(indent=2) }}</pre>
    {% endif %}

    {% if text %}
        <h2>Analyse</h2>
        <div>{{ text | safe }}</div>
    {% endif %}

    {% if charts %}
        <h2>Graphiques</h2>
        <div id="charts-container">
            {% for chart in charts %}
                <div id="chart-{{ loop.index0 }}"></div>
                <script>
                    var figure = {{ chart | tojson | safe }};
                    var layout = figure.layout || {};
                    layout.autosize = true; // Rend le graphique responsive
                    layout.margin = layout.margin || { t: 40, b: 40, l: 40, r: 40 };

                    Plotly.newPlot(
                        'chart-{{ loop.index0 }}',
                        figure.data,
                        layout,
                        { responsive: true }
                    );
                </script>
            {% endfor %}
        </div>
    {% endif %}
</body>
</html>
